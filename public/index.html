<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Blog API Practice</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="p-5">
    <h1 class="mb-4">Blog Posts</h1>

    <div id="posts" class="mb-4"></div>

    <h3>Add Post</h3>
    <form id="postForm">
      <input
        class="form-control mb-2"
        type="text"
        id="title"
        placeholder="Title"
        required
      />
      <textarea
        class="form-control mb-2"
        id="content"
        placeholder="Content"
        required
      ></textarea>
      <button class="btn btn-primary" type="submit">Add Post</button>
    </form>

    <script>
      const postsContainer = document.getElementById("posts");
      const form = document.getElementById("postForm");

      function fetchPosts() {
        fetch("/api/posts")
          .then((res) => res.json())
          .then((data) => {
            postsContainer.innerHTML = "";
            data.forEach((post) => {
              postsContainer.innerHTML += `
              <div class="border p-3 mb-2">
                <h4>${post.title}</h4>
                <p>${post.content}</p>
                <button class="btn btn-sm btn-danger" onclick="deletePost(${post.id})">Delete</button>
              </div>
            `;
            });
          });
      }

      function deletePost(id) {
        fetch(`/api/posts/${id}`, { method: "DELETE" }).then(() =>
          fetchPosts()
        );
      }

      form.addEventListener("submit", function (e) {
        e.preventDefault();
        const title = document.getElementById("title").value;
        const content = document.getElementById("content").value;

        fetch("/api/posts", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ title, content }),
        }).then(() => {
          form.reset();
          fetchPosts();
        });
      });

      fetchPosts();
    </script>
  </body>
</html>
